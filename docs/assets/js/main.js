"use strict";let favouriteList=[],selectedFilm=[];const btn=document.querySelector(".js-search-btn"),imgTemporary="https://via.placeholder.com/210x295/ffffff/666666/";function createFilm(e){let t=favouriteList.findIndex(t=>t.show.id===e.show.id)>=0,a='<article class="js-article" id="art-'+e.show.id+'">';return a+='<p class="js-title">'+e.show.name+"</p>",t?(a+='<img class="js-image-film box-shadow" src="'+image(e)+'" alt="Carátula de la película">',a+='<i class="fas fa-heart js-heart background"></i>'):(a+='<img class="js-image-film" src="'+image(e)+'" alt="Carátula de la película">',a+='<i class="fas fa-heart js-heart"></i>'),a+="</article>",a}function image(e){return null===e.show.image?imgTemporary:e.show.image.medium}function createFavourites(e){let t='<li class="wrapper-li >';return t+='<p class="">'+e.show.name+"</p>",null===e.show.image?t+='<img class="js-image-film" src="'+imgTemporary+'" alt="Carátula de la película">':t+='<img class="js-image-film" src="'+e.show.image.medium+'" alt="Carátula de la película">',t+='<i class="fas fa-times-circle" id="list-'+e.show.id+'"></i>',t+="</li>",t}function paintFilm(e){document.querySelector(".wrapper-films").innerHTML+=createFilm(e)}function paintFavourite(e){document.querySelector(".js-favourites").innerHTML+=createFavourites(e)}function chargeFilm(e){document.querySelector(".wrapper-films").innerHTML="";for(let t of e)paintFilm(t)}function chargeFavourite(e){document.querySelector(".js-favourites").innerHTML="";for(let t of e)paintFavourite(t);let t=document.querySelectorAll(".fa-times-circle");for(let e of t)e.addEventListener("click",removeFavs)}function userSearch(e){e.preventDefault();const t=document.querySelector(".js-user-Search").value;fetch("http://api.tvmaze.com/search/shows?q="+t).then((function(e){return e.json()})).then((function(e){selectedFilm=e,chargeFilm(e);let t=document.querySelectorAll("article");for(let e of t)e.addEventListener("click",changeArticle)}))}function changeArticle(e){let t=parseInt(e.currentTarget.id.substring(4)),a=e.currentTarget.querySelector(".js-heart"),i=e.currentTarget.querySelector(".js-image-film");if(a.classList.toggle("background"),i.classList.toggle("box-shadow"),a.classList.contains("background")||i.classList.contains("background")){let e=selectedFilm.find(e=>e.show.id===t);favouriteList.push(e)}else{let e=favouriteList.findIndex(e=>e.show.id===t);e>=0&&favouriteList.splice(e,1)}chargeFavourite(favouriteList),localStorage.setItem("fav",JSON.stringify(favouriteList))}function removeFavs(e){let t=parseInt(e.currentTarget.id.substring(5)),a=favouriteList.findIndex(e=>e.show.id===t);a>=0&&favouriteList.splice(a,1),chargeFavourite(favouriteList);let i=document.querySelector("#art-"+t);if(null!==i){i.querySelector(".js-heart").classList.remove("background"),i.querySelector(".js-image-film").classList.remove("box-shadow")}localStorage.setItem("fav",JSON.stringify(favouriteList))}function loadPage(){let e=localStorage.getItem("fav");null!==e&&(favouriteList=JSON.parse(e),chargeFavourite(favouriteList))}btn.addEventListener("click",userSearch),window.onload=loadPage;